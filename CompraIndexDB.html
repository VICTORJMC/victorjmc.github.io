<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de la Compra</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        button{font-size:0.7em;

        }
        input{font-size:0.8em;
          }
    </style>
</head>
<body>
    <h2>Lista de la Compra</h2>
    <h2><input type="text" id="nuevoArticulo" placeholder="Nuevo art√≠culo">
    <button onclick="agregarArticulo()">‚ûï</button></h2>
   
    <table id="tablaArticulos">
        <thead>
            <tr>
                <th>Art√≠culo</th>
                <th>Fecha</th>
                <th>Borrar</th>
            </tr>
        </thead>
        <tbody>
            <!-- Los art√≠culos se agregar√°n aqu√≠ -->
        </tbody>
    </table>
    <h2>
   
<button onclick="comprar()">üõí</button></h2><script>
let db;

const articulos = ['üç´CHOCOLATE','ü•§COCA-COLA','üíßAGUA','ü•õLECHE','üç™GALLETAS','ü•úFRUTOS SECOS','üçèManzanas','üçåPlatanos','üçàLimones','üçäNaranjas','üçÉLima','üçëMelocoton','üçáUvas','üççPi√±a','üçâSandia','ü´íACEITE-AOVE','ü•ëAguacate','üßÖCebolla','ü•¨Lechuga','ü´ëPimiento','üçÖTomates','ü•ïZanahorias','üçÑChampi√±ones','üå∂Ô∏èJalape√±os','ü•îPatatas','ü´íACEITUNAS','üå∞Lentejas','ü•¶Guisantes','ü•öHUEVOS','üçóPOLLO','üçñPAVO','üê∑JAM√ìN',üçûPAN','üçöARROZ','üçùPASTA','üßãYOGURT','üßÄQUESO','ü•£AVENA','‚òïCAFE','üßªRollo Cocina','üßªHiji√©nico','üß¥CHAMP√ö','üßºGEL DUCHA','üöÆBOLSA BASURA','üß∑PA√ëALES','üìúTOALLITAS'];

// Abrir la base de datos
const request = indexedDB.open('articulosDB', 1);

request.onupgradeneeded = function(event) {
    db = event.target.result;
    if (!db.objectStoreNames.contains('articulos')) {
        db.createObjectStore('articulos', { keyPath: 'id', autoIncrement: true });
    }
};

request.onsuccess = function(event) {
    db = event.target.result;
    cargarTodos();
};

request.onerror = function(event) {
    console.error('Error al abrir la base de datos', event);
};

function agregarArticulo() {
    const articuloInput = document.getElementById('nuevoArticulo');
    const articulo = articuloInput.value.trim();
    if (articulo === '') return;
    const fecha = new Date().toLocaleDateString();

    const transaction = db.transaction(['articulos'], 'readwrite');
    const objectStore = transaction.objectStore('articulos');
    objectStore.add({ articulo, fecha });

    transaction.oncomplete = function() {
        console.log('Art√≠culo a√±adido');
        articuloInput.value = '';
        cargarTodos();
    };

    transaction.onerror = function(event) {
        console.error('Error al a√±adir el art√≠culo', event);
    };
}

function comprar() {
    const fecha = new Date().toLocaleDateString();

    const transaction = db.transaction(['articulos'], 'readwrite');
    const objectStore = transaction.objectStore('articulos');

    articulos.forEach(articulo => {
        objectStore.add({ articulo, fecha });
    });

    transaction.oncomplete = function() {
        console.log('Art√≠culos a√±adidos');
        cargarTodos();
    };

    transaction.onerror = function(event) {
        console.error('Error al a√±adir los art√≠culos', event);
    };
}

function cargarTodos() {
    const transaction = db.transaction(['articulos'], 'readonly');
    const objectStore = transaction.objectStore('articulos');
    const request = objectStore.getAll();

    request.onsuccess = function(event) {
        const articulos = event.target.result;
        const tablaBody = document.querySelector('#tablaArticulos tbody');
        tablaBody.innerHTML = '';

        articulos.forEach(item => {
            const fila = document.createElement('tr');

            const celdaArticulo = document.createElement('td');
            celdaArticulo.textContent = item.articulo;
            fila.appendChild(celdaArticulo);

            const celdaFecha = document.createElement('td');
            celdaFecha.textContent = item.fecha;
            fila.appendChild(celdaFecha);

            const celdaBorrar = document.createElement('td');
            const botonBorrar = document.createElement('button');
            botonBorrar.textContent = '‚ùå';
            botonBorrar.onclick = function() {
                borrarArticulo(item.id);
            };
            celdaBorrar.appendChild(botonBorrar);
            fila.appendChild(celdaBorrar);

            tablaBody.appendChild(fila);
        });
    };

    request.onerror = function(event) {
        console.error('Error al cargar los art√≠culos', event);
    };
}

function borrarArticulo(id) {
    const transaction = db.transaction(['articulos'], 'readwrite');
    const objectStore = transaction.objectStore('articulos');
    objectStore.delete(id);

    transaction.oncomplete = function() {
        console.log('Art√≠culo borrado');
        cargarTodos();
    };

    transaction.onerror = function(event) {
        console.error('Error al borrar el art√≠culo', event);
    };
}

window.onload = function() {
    cargarTodos();
};

       
    </script>
</body>
</html>
